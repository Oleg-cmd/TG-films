(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2108:function(e,t,s){Promise.resolve().then(s.bind(s,8653))},8653:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return f}});var n=s(7437),a=s(3301),r=s(2265),i=s(1038),l=s(5042),o=s(1809),c=s(9828),d=s(1396),u=s.n(d),g=s(1100),h=s(9366),m=s(4033),p=s(4829);let x=new Date().getFullYear(),b=(0,g.Pi)(()=>{let e=(0,m.useRouter)(),[t,s]=(0,r.useState)(!1),[a,d]=(0,r.useState)([]);return(0,r.useEffect)(()=>{h.c.setIsReady(!1),h.c.connect();let e=async()=>{try{let e=await p.Z.get("".concat("http://localhost:8080","/api/genres"));d(e.data.map(e=>e.name))}catch(e){console.log("Error fetching genres:",e)}};e()},[h.c.selectedGenres,h.c.startYear,h.c.endYear,h.c.rating]),(0,n.jsxs)("div",{className:"p-4 flex flex-col justify-between bg-gradient-to-br from-blue-100 to-purple-100 rounded-lg shadow-lg h-screen",children:[(0,n.jsx)("button",{onClick:()=>{h.c.inviteCode?h.c.sendMessage({type:"join",telegramId:h.c.telegramId||"user123",inviteCode:h.c.inviteCode}):h.c.sendMessage({type:"connect",telegramId:h.c.telegramId||"user123"})},className:"bg-blue-600 text-white hover:bg-blue-700  p-2 rounded-md",children:"Connect"}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"p-2 flex justify-between items-center",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-center text-blue-800",children:"Film Preferences"}),(0,n.jsx)("div",{className:"flex justify-end p-4",children:(0,n.jsx)(u(),{href:"/settings",children:(0,n.jsx)(o.Z,{className:"w-8 h-8 text-blue-600 cursor-pointer"})})})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("h2",{className:"text-xl font-semibold text-blue-700 flex items-center gap-2",children:["Genres",(0,n.jsx)("button",{onClick:()=>s(!0),className:"p-2 rounded-full bg-blue-200 hover:bg-blue-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus-ring-offset-1",children:(0,n.jsx)(c.Z,{className:"h-6 w-6 text-blue-700"})})]}),(0,n.jsx)(i.u,{appear:!0,show:t,as:r.Fragment,children:(0,n.jsxs)(l.Vq,{as:"div",className:"relative z-10",onClose:()=>s(!1),children:[(0,n.jsx)(i.u.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,n.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,n.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,n.jsx)(i.u.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,n.jsxs)(l.Vq.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all",children:[(0,n.jsx)(l.Vq.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 mb-4",children:"Select Genres"}),(0,n.jsx)("div",{className:"grid grid-cols-2 gap-3",children:a.map(e=>(0,n.jsx)("button",{onClick:()=>h.c.toggleGenre(e),className:"".concat(h.c.selectedGenres.includes(e)?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"," p-2 rounded-md shadow transition-colors w-full"),children:e},e))}),(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)("button",{type:"button",className:"inline-flex justify-center rounded-md border border-transparent bg-blue-100 px-4 py-2 text-sm font-medium text-blue-900 hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",onClick:()=>s(!1),children:"Close"})})]})})})})]})})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-blue-700",children:"Year Range"}),(0,n.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,n.jsxs)("label",{className:"text-sm text-blue-600",children:["Start Year: ",h.c.startYear]}),(0,n.jsx)("input",{type:"range",min:1900,max:x,value:h.c.startYear,onChange:e=>{h.c.setStartYear(parseInt(e.target.value))},className:"w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer"}),(0,n.jsxs)("label",{className:"text-sm text-blue-600",children:["End Year: ",h.c.endYear]}),(0,n.jsx)("input",{type:"range",min:1900,max:x,value:h.c.endYear,onChange:e=>{h.c.setEndYear(parseInt(e.target.value))},className:"w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer"})]})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-blue-700",children:"Minimum Rating"}),(0,n.jsx)("input",{type:"range",min:1,max:10,step:.1,value:h.c.rating,onChange:e=>{h.c.setRating(parseFloat(e.target.value))},className:"w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer"}),(0,n.jsxs)("div",{className:"text-center text-sm text-blue-600",children:[h.c.rating.toFixed(1)," / 10"]})]})]}),(0,n.jsx)("button",{onClick:()=>{h.c.setIsReady(!0),h.c.sendMessage({type:"ready",telegramId:h.c.telegramId||"user123",inviteCode:h.c.inviteCode}),e.push("/game")},disabled:0===h.c.selectedGenres.length||h.c.isReady,className:"w-full py-3 px-4 rounded-lg mt-6 text-lg font-semibold transition-all transform hover:scale-105 ".concat(h.c.isReady?"bg-gray-400 text-white cursor-not-allowed":0===h.c.selectedGenres.length?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700 shadow-lg"),children:h.c.isReady?"Waiting for others... ".concat(h.c.readyCount||0,"/1"):"Ready to Swipe!"})]})});function f(){return(0,n.jsxs)("main",{className:"min-h-screen h-full mx-auto bg-gameSwipe-neutral",children:[(0,n.jsx)(a.b,{}),(0,n.jsx)(b,{})]})}},3301:function(e,t,s){"use strict";s.d(t,{b:function(){return u}});var n=s(7437),a=s(2265),r=s(4949),i=s(6061),l=s(7042),o=s(3986);window.innerWidth;let c=(0,i.j)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-transparent shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,t)=>{let{className:s,variant:a,size:i,asChild:d=!1,...u}=e,g=d?r.g7:"button";return(0,n.jsx)(g,{className:function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,o.m)((0,l.W)(t))}(c({variant:a,size:i,className:s})),ref:t,...u})});d.displayName="Button";var u=()=>(0,n.jsx)("div",{className:"absolute inset-0 opacity-[0.05] pointer-events-none",style:{backgroundImage:"url('/images/svg/topography.svg')",backgroundSize:"400px"}})},9366:function(e,t,s){"use strict";s.d(t,{c:function(){return i}});var n=s(4256),a=s(8136);let r=(e,t,s)=>{let n=new WebSocket("wss://localhost:8080/ws"),r=a.over(n);return r.connect(function(){e(r)},e=>{t(e)},e=>{s(e)}),r},i=new class{setInviteCode(e){this.inviteCode=e}getDestination(e,t){return"connect"===t?"/app/connect":"join"===t?"/app/rooms/".concat(e,"/join"):"settings"===t?"/app/rooms/".concat(e,"/settings"):"ready"===t?"/app/rooms/".concat(e,"/ready"):"swipe"===t?"/app/rooms/".concat(e,"/swipe"):""}setStartYear(e){this.startYear=e,this.isReady=!1}setEndYear(e){this.endYear=e,this.isReady=!1}setRating(e){this.rating=e,this.isReady=!1}setIsReady(e){this.isReady=e}setReadyCount(e){this.readyCount=e}constructor(){this.selectedGenres=["Drama"],this.startYear=1990,this.endYear=new Date().getFullYear(),this.rating=5,this.isReady=!1,this.readyCount=void 0,this.inviteCode=null,this.stompClient=null,this.telegramId=null,this.connect=()=>{let e=new URLSearchParams(window.location.search),t=e.get("inviteCode")||null;this.telegramId=e.get("telegramId")||"user123",this.stompClient=r(e=>{e.subscribe("/topic/connect",e=>{try{let t=JSON.parse(e.body);t.inviteCode&&this.setInviteCode(t.inviteCode)}catch(e){console.log("no code in this message")}}),t&&this.sendMessage({type:"join",telegramId:this.telegramId,inviteCode:t})},e=>{console.error("Error connecting to STOMP:",e)},e=>{console.error("Error on connecting: ",e)})},this.sendMessage=e=>{if(this.stompClient&&this.stompClient.connected){let t;let s=this.getDestination(e.inviteCode,e.type);"connect"===e.type?(t=e.telegramId,this.stompClient.send(s,{},t)):"join"===e.type?(t=e.telegramId,this.stompClient.send(s,{},t)):"settings"===e.type?(t=JSON.stringify(e.settings),this.stompClient.send(s,{},t)):"ready"===e.type?(t=e.telegramId,this.stompClient.send(s,{},t)):"swipe"===e.type&&(t=JSON.stringify(e.payload),this.stompClient.send(s,{},t)),console.log("Sent: "+JSON.stringify(e))}else console.log("Socket is not connected.")},this.toggleGenre=e=>{this.selectedGenres=this.selectedGenres.includes(e)?this.selectedGenres.filter(t=>t!==e):[...this.selectedGenres,e],this.isReady=!1},(0,n.ky)(this)}}}},function(e){e.O(0,[147,922,119,42,400,971,864,744],function(){return e(e.s=2108)}),_N_E=e.O()}]);